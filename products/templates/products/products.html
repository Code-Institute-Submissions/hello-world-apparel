{% extends 'base.html' %}

{% load static %}

{% block page_header %}
<div class="container header-container">
	<div class="row mt-4">
		<div class="col">
			{% include 'partials/_breadcrumbs.html' %}
		</div>
	</div>
</div>
{% endblock %}

{% block content %}
<div class="overlay"></div>
<div class="container-fluid">
	<div class="row">
		<div class="col text-center mt-3">
			<h2 class="logo-font">Products</h2>
		</div>
	</div>
	<div class="row">
		<div class="product-container col-10 offset-1">
			<div class="row mt-1 mb-2"></div>
			<div class="row">
				<div class="col-md-3">
					<h6>Filter by Category</h6>
					<ul class="nav flex-column">
						<li class="nav-item">
							<a class="nav-link"
								href="{% url 'products' %}?category=tshirts"><i class="fas fa-tshirt mr-2"></i>T-Shirts</a>
						</li>
						<li class="nav-item">
							<a class="nav-link"
								href="{% url 'products' %}?category=masks"><i class="fas fa-head-side-mask mr-2"></i>Masks</a>
						</li>
						<li class="nav-item">
							<a class="nav-link"
								href="{% url 'products' %}?category=pins"><i class="fas fa-certificate mr-2"></i>Pins</a>
						</li>
						<li class="nav-item">
							<a class="nav-link"
								href="{% url 'products' %}?category=mugs"><i class="fas fa-coffee mr-2"></i>Mugs</a>
						</li>
					</ul>
				</div>
				<div class="col-md-9">
					<div class="row mb-3">
						<div class="col text-right">
							<form method="GET" action="{% url 'products' %}">
								<div class="dropdown">
									<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Sort by
  </button>
									<div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
										<a class="dropdown-item"
											href="{% url 'products' %}?sort=price&direction=asc">Price - Low to High</a>
										<a class="dropdown-item"
											href="{% url 'products' %}?sort=price&direction=desc">Price - High to
											Low</a>
										<a class="dropdown-item" href="#">Popular</a>
									</div>
								</div>
							</form>
						</div>
					</div>
					<div class="row">
						{% for product in products %}
						<div class="col-sm-6 col-md-6 col-lg-3 col-xl-3 mb-3 mt-3">
							<div class="card h-100 product-card">
								{% if product.image %}
								<a href="{% url 'product_detail' product.id %}">
									<img class="card-img-top img-fluid" src="{{ product.image.url }}" alt="{{ product.name }}">
                                </a>
									{% else %}
									<a href="{% url 'product_detail' product.id %}">
										<img class="card-img-top img-fluid" src="{{ MEDIA_URL }}no-available-image.png" alt="{{ product.name }}">
                                </a>
										{% endif %}
										<div class="card-body pb-0">
											<h6 class="mb-2"><strong>{{ product.name }}</strong></h6>
										</div>
										<div class="card-footer bg-white pt-0 border-0 text-left">
											<div class="row">
												<div class="col">
													<p class="text-left price-tag">${{ product.price }}</p>
												</div>
											</div>
										</div>
										{% if request.user.is_superuser %}
										<small class="ml-3">
                                                    <a href="{% url 'edit_product' product.id %}">Edit</a> | 
                                                    <a class="text-danger" href="{% url 'delete_product' product.id %}">Delete</a>
                                                </small>
										{% endif %}
							</div>
						</div>
						{% endfor %}
					</div>
					<nav aria-label="pagination for product listings">
						{% if products.has_other_pages %}
						<ul class="pagination justify-content-end">
							{% if products.has_previous %}
							<li class="page-item">
								<a href="?page={{ products.previous_page_number }}" class="page-link">&laquo;</a>
							</li>
							{% else %}
							<li class="page-item disabled">
								<a href="" class="page-link">&laquo;</a>
							</li>
							{% endif %}
							{% for i in products.paginator.page_range %}
							{% if products.number == i %}
							<li class="page-item active">
								<a class="page-link">{{ i }}</a>
							</li>
							{% else %}
							<li class="page-item">
								<a href="?page={{ i }}" class="page-link">{{ i }}</a>
							</li>
							{% endif %}
							{% endfor %}
                            {% if products.has_next %}
							<li class="page-item">
								<a href="?page={{ products.next_page_number }}" class="page-link">&raquo;</a>
							</li>
							{% else %}
							<li class="page-item disabled">
								<a href="" class="page-link">&raquo;</a>
							</li>
							{% endif %}
						</ul>
						{% endif %}
					</nav>
				</div>
			</div>
		</div>
	</div>
</div>

{% endblock %}